---
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const SUPABASE_KEY = "sb_publishable_TwTcczdp-s3B_-OdFvGRdw_t0GfJbwD";

  const response = await fetch(
    "https://vhfeaaqjpnquzuwqkcqn.supabase.co/rest/v1/cafes?select=id,name,description,img",
    {
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`,
      },
    }
  );

  const data: any[] = await response.json();

  return data.map((cafe) => ({
    params: { id: String(cafe.id) },
    props: { cafe },
  }));
}

const { cafe } = Astro.props as { cafe: any };
---

<Layout title={cafe?.name ?? "Café"}>
  <main class="cafe">
    <h1>{cafe?.name}</h1>
    <p>{cafe?.description}</p>

    {cafe?.img ? (
      <img src={cafe.img} alt={cafe?.name ?? "Café"} />
    ) : (
      <p>(Intet billede fundet)</p>
    )}
  </main>

  <style>
    .cafe {
      max-width: 430px;
      margin: 20px auto;
      padding: 0 20px;
    }

    .cafe h1 {
      margin: 0 0 10px;
    }

    .cafe p {
      margin: 0 0 12px;
      line-height: 1.45;
    }

    .cafe img {
      width: 100%;
      height: auto;
      display: block;
      margin-top: 16px;
      border-radius: 14px;
    }
  </style>
</Layout>
